function pageY(e){return e.offsetParent?e.offsetTop+pageY(e.offsetParent):e.offsetTop}$(function(){var e={id:$(this),item:$(this).find(".timeline-item"),activeClass:"timeline-item--active",img:".timeline__img"},i=(e.item.length,0),t=!1,n=function(){var n,s,a=$(window).scrollTop();a>$(".header-h").eq(1).offset().top-60?$("#app").removeClass("nofixed"):$("#app").addClass("nofixed"),a>$(".timeline").offset().top-60?$("#timeline").addClass("fixed"):$("#timeline").removeClass("fixed");var o=$(window).width()<800?pageY($(".timeline-item").last().get(0))+$(".timeline-item").last().height()-$(window).height():pageY($(".timeline-item").last().get(0))-$(window).height()/4;a>o?$("#timeline").addClass("end"):$("#timeline").removeClass("end"),e.item.each(function(o){s=$(this).offset().top-$(window).height()/2,n=$(this).outerHeight()+pageY($(this).get(0));$(this);if(a>=s&&$(this).addClass(e.activeClass),a<=n-$(window).height()/2&&a>=s){if(t)return;t=!0,0==i?($(".year").eq(0).addClass("hide"),$(".year").eq(1).html($(this).find(".timeline__content-title").html()).removeClass("hide"),i=1):(i=0,$(".year").eq(1).addClass("hide"),$(".year").eq(0).html($(this).find(".timeline__content-title").html()).removeClass("hide")),setTimeout(function(){t=!1},300)}}),$(".timeline-area").each(function(e){s=$(this).offset().top-$(window).height()/2,n=$(this).outerHeight()+$(this).offset().top-$(window).height()/2;$(this);a<=n-40&&a>=s&&($(".year-nav li").removeClass("active"),$(".year-nav li").eq(e).addClass("active"),$(".year-nav li").eq(e).find("svg circle:eq(1)").css("stroke-dashoffset",160-(a-s)/(n-s)*160))})};$(window).scroll(n),n(),(navigator.userAgent.indexOf("MSIE")>0||navigator.userAgent.indexOf("Trident/")>0)&&$(".timeline-area").each(function(){var e=0;$(this).find(".timeline-item").each(function(){e+=$(this).outerHeight(),console.log($(this).outerHeight())}),$(this).height(e+($(window).width()<=800?0:150))})});